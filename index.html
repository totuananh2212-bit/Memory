<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Mini Soccer 3D</title>
  <style>
    body { margin: 0; overflow: hidden; background: #222; }
    canvas { display: block; }
    #scoreboard {
      position: absolute; top: 10px; left: 50%;
      transform: translateX(-50%);
      color: white; font-family: Arial; font-size: 20px;
    }
  </style>
</head>
<body>
  <div id="scoreboard">Time: 180 | Score 0 - 0</div>
  <script src="https://cdn.jsdelivr.net/npm/three@0.154/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.154/examples/js/controls/OrbitControls.js"></script>
  <script>
    // Scene + Camera
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.set(0, 50, 70);
    camera.lookAt(0,0,0);

    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Light
    const light = new THREE.DirectionalLight(0xffffff, 1);
    light.position.set(20,50,20);
    scene.add(light);
    scene.add(new THREE.AmbientLight(0x888888));

    // Pitch
    const fieldGeom = new THREE.PlaneGeometry(100, 60);
    const fieldMat = new THREE.MeshPhongMaterial({color:0x228B22});
    const field = new THREE.Mesh(fieldGeom, fieldMat);
    field.rotation.x = -Math.PI/2;
    scene.add(field);

    // Goals
    const goalMat = new THREE.MeshPhongMaterial({color:0xffffff});
    const goal1 = new THREE.Mesh(new THREE.BoxGeometry(1,10,20), goalMat);
    goal1.position.set(-50,5,0);
    scene.add(goal1);
    const goal2 = goal1.clone();
    goal2.position.set(50,5,0);
    scene.add(goal2);

    // Ball
    const ballGeom = new THREE.SphereGeometry(1, 16, 16);
    const ballMat = new THREE.MeshPhongMaterial({color:0xffffff});
    const ball = new THREE.Mesh(ballGeom, ballMat);
    ball.position.set(0,1,0);
    scene.add(ball);

    // Players (simple box)
    function createPlayer(color, x, z) {
      const mat = new THREE.MeshPhongMaterial({color: color});
      const p = new THREE.Mesh(new THREE.BoxGeometry(2,4,2), mat);
      p.position.set(x,2,z);
      scene.add(p);
      return p;
    }
    const player = createPlayer(0x0000ff, 0,0); // bạn
    const keeper1 = createPlayer(0xff0000, -45,0);
    const keeper2 = createPlayer(0x00ff00, 45,0);

    // Controls
    const keys = {};
    document.addEventListener('keydown', e=>keys[e.key.toLowerCase()]=true);
    document.addEventListener('keyup', e=>keys[e.key.toLowerCase()]=false);

    let velocity = new THREE.Vector3();
    let ballVel = new THREE.Vector3();
    let time = 180; let scoreA=0, scoreB=0;

    function resetBall() {
      ball.position.set(0,1,0);
      ballVel.set(0,0,0);
    }

    function animate() {
      requestAnimationFrame(animate);

      // Move player
      let speed = keys['e'] ? 0.4 : 0.2;
      if(keys['arrowup']||keys['w']) player.position.z -= speed;
      if(keys['arrowdown']||keys['s']) player.position.z += speed;
      if(keys['arrowleft']||keys['a']) player.position.x -= speed;
      if(keys['arrowright']||keys['d']) player.position.x += speed;

      // Ball physics
      ball.position.add(ballVel);
      ballVel.multiplyScalar(0.98); // friction
      if(ball.position.y < 1) ball.position.y = 1;

      // Kick / pass
      if(keys[' ']) { // Space = sút
        if(player.position.distanceTo(ball.position)<3) {
          const dir = new THREE.Vector3().subVectors(ball.position, player.position).normalize();
          ballVel.add(dir.multiplyScalar(0.8));
        }
      }

      // Goal detection
      if(ball.position.x < -49 && Math.abs(ball.position.z)<10) { scoreB++; resetBall(); }
      if(ball.position.x > 49 && Math.abs(ball.position.z)<10) { scoreA++; resetBall(); }

      // Keeper AI (đi theo bóng trong vùng cấm)
      keeper1.position.z = THREE.MathUtils.clamp(ball.position.z, -8, 8);
      keeper2.position.z = THREE.MathUtils.clamp(ball.position.z, -8, 8);

      // Scoreboard
      document.getElementById('scoreboard').innerText = 
        `Time: ${time} | Score ${scoreA} - ${scoreB}`;

      renderer.render(scene, camera);
    }
    animate();

    // Timer
    setInterval(()=>{
      if(time>0) time--;
    },1000);

    window.addEventListener('resize',()=>{
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>


