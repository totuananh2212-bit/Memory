<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WOLF by ToAh</title>
<style>
  body { margin:0; overflow:hidden; background:#87CEEB; font-family:sans-serif; }
  canvas { display:block; background:#87CEEB; margin:0 auto; }
  #menu { position:absolute; width:100%; height:100%; top:0; left:0; background:rgba(0,0,0,0.7);
          display:flex; flex-direction:column; justify-content:center; align-items:center; color:white; }
  #menu input { font-size:20px; padding:5px; margin:10px; }
  #menu button { font-size:20px; padding:5px 15px; margin:10px; }
  #menu select { font-size:20px; padding:5px; margin:10px; }
</style>
</head>
<body>
<div id="menu">
  <h1>WOLF by ToAh</h1>
  <input type="text" id="playerName" placeholder="Enter name"/>
  <select id="playerColor">
    <option value="gray">Gray</option>
    <option value="blue">Blue</option>
    <option value="red">Red</option>
    <option value="green">Green</option>
    <option value="yellow">Yellow</option>
    <option value="purple">Purple</option>
  </select>
  <button onclick="startGame()">Start Game</button>
</div>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
let playerName="", playerColor="gray";
let keys={};
let player, platforms=[], mushrooms=[], enemies=[], bosses=[], fireballs=[];
let level=1;

document.addEventListener("keydown", e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup", e=>keys[e.key.toLowerCase()]=false);

function startGame(){
  playerName=document.getElementById("playerName").value||"Wolf";
  playerColor=document.getElementById("playerColor").value;
  document.getElementById("menu").style.display="none";
  initLevel(level);
  requestAnimationFrame(gameLoop);
}

function Player(x,y,color){
  this.x=x; this.y=y; this.width=50; this.height=50;
  this.color=color; this.velY=0; this.onGround=false; this.isBig=false; this.canShoot=false;
}
Player.prototype.update=function(){
  if(keys["arrowleft"]) this.x-=5;
  if(keys["arrowright"]) this.x+=5;
  if(keys["s"] && this.onGround){ this.velY=-15; this.onGround=false; }
  this.velY+=1; if(this.velY>15) this.velY=15;
  this.y+=this.velY;
  if(this.y+this.height>=550){ this.y=550-this.height; this.velY=0; this.onGround=true; }
};
Player.prototype.grow=function(){
  if(!this.isBig){ this.width*=1.5; this.height*=1.5; this.isBig=true; this.canShoot=true; }
};
Player.prototype.draw=function(){ ctx.fillStyle=this.color; ctx.fillRect(this.x,this.y,this.width,this.height); };

function Platform(x,y,w,h){ this.x=x; this.y=y; this.width=w; this.height=h; }
Platform.prototype.draw=function(){ ctx.fillStyle="black"; ctx.fillRect(this.x,this.y,this.width,this.height); };

function Mushroom(x,y){ this.x=x; this.y=y; this.width=30; this.height=30; }
Mushroom.prototype.draw=function(){ ctx.fillStyle="red"; ctx.fillRect(this.x,this.y,this.width,this.height); };

function Enemy(x,y,speed){ this.x=x; this.y=y; this.width=40; this.height=40; this.speed=speed; }
Enemy.prototype.update=function(){ this.x+=this.speed; if(this.x<=0||this.x+this.width>=800) this.speed*=-1; };
Enemy.prototype.draw=function(){ ctx.fillStyle="green"; ctx.fillRect(this.x,this.y,this.width,this.height); };

function Boss(x,y,health){ this.x=x; this.y=y; this.width=100; this.height=100; this.health=health; this.speed=3; }
Boss.prototype.update=function(){ this.x+=this.speed; if(this.x<=0||this.x+this.width>=800) this.speed*=-1; };
Boss.prototype.draw=function(){ ctx.fillStyle="purple"; ctx.fillRect(this.x,this.y,this.width,this.height); };

function Fireball(x,y,direction){ this.x=x; this.y=y; this.width=15; this.height=15; this.speed=10*direction; }
Fireball.prototype.update=function(){ this.x+=this.speed; };
Fireball.prototype.draw=function(){ ctx.fillStyle="yellow"; ctx.fillRect(this.x,this.y,this.width,this.height); };

function initLevel(lv){
  player=new Player(100,500,playerColor);
  platforms=[new Platform(0,550,800,50), new Platform(200,450-20*(lv-1),150,20), new Platform(500,350-20*(lv-1),150,20)];
  mushrooms=[new Mushroom(220,420-20*(lv-1)), new Mushroom(520,320-20*(lv-1))];
  enemies=[]; for(let i=0;i<lv+1;i++) enemies.push(new Enemy(Math.random()*700,500,2+lv));
  bosses=[new Boss(650,450,10+lv*2)];
  fireballs=[];
}

function rectsCollide(a,b){ return a.x<a.x+b.width && a.x+b.width>b.x && a.y<a.y+b.height && a.y+b.height>b.y; }

function gameLoop(){
  ctx.clearRect(0,0,800,600);
  player.update();
  platforms.forEach(p=>{ if(player.y+player.height>=p.y && player.y+player.height<=p.y+player.velY+15 && player.x+player.width>p.x && player.x<p.x+p.width){ player.y=p.y-player.height; player.velY=0; player.onGround=true; }});
  mushrooms.forEach((m,i)=>{ if(player.x< m.x+m.width && player.x+player.width>m.x && player.y< m.y+m.height && player.y+player.height>m.y){ mushrooms.splice(i,1); player.grow(); }});
  enemies.forEach(e=>{ e.update(); if(player.x< e.x+e.width && player.x+player.width>e.x && player.y< e.y+e.height && player.y+player.height>e.y){ console.log(playerName+" bị thương!"); } });
  fireballs.forEach((f,i)=>{ f.update(); enemies.forEach((e,j)=>{ if(rectsCollide(f,e)){ enemies.splice(j,1); fireballs.splice(i,1); } }); bosses.forEach((b,k)=>{ if(rectsCollide(f,b)){ b.health--; fireballs.splice(i,1); if(b.health<=0){ bosses.splice(k,1); console.log("BOSS màn "+level+" bị tiêu diệt!"); } } }); });
  if(keys["f"] && player.canShoot && (!this.lastShot || Date.now()-this.lastShot>300)){ let dir=keys["arrowright"]?1:-1; fireballs.push(new Fireball(player.x+player.width/2,player.y+player.height/2,dir)); this.lastShot=Date.now(); }
  player.draw();
  platforms.forEach(p=>p.draw());
  mushrooms.forEach(m=>m.draw());
  enemies.forEach(e=>e.draw());
  bosses.forEach(b=>b.draw());
  fireballs.forEach(f=>f.draw());
  ctx.fillStyle="black"; ctx.fillText("Player: "+playerName+"  Level: "+level,10,20);
  if(bosses.length===0){ level++; if(level>5){ alert("Bạn đã chiến thắng tất cả màn!"); return; } initLevel(level); }
  requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>










